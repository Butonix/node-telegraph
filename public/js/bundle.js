!function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){const i=n(1);window.Medium=i,new i({element:document.querySelector("#post-form .post-form__heading-content"),placeholder:"Title",mode:i.partialMode}),new i({element:document.querySelector("#post-form .post-form__author-content"),placeholder:"Your name",mode:i.inlineMode}),new i({element:document.querySelector("#post-form .post-form__story-content"),placeholder:"Your story"})},function(e,t,n){var i;(function(r,o){"use strict";var a=function(){var e=function(e){return e.replace(/^\s+|\s+$/g,"")},t=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1},n=r.rangy||null,i=r.Undo||null,a=!n||!i,l=r.Key={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capsLock:20,escape:27,pageUp:33,pageDown:34,end:35,home:36,leftArrow:37,upArrow:38,rightArrow:39,downArrow:40,insert:45,delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,leftWindow:91,rightWindowKey:92,select:93,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,multiply:106,add:107,subtract:109,decimalPoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numLock:144,scrollLock:145,semiColon:186,equalSign:187,comma:188,dash:189,period:190,forwardSlash:191,graveAccent:192,openBracket:219,backSlash:220,closeBraket:221,singleQuote:222},s=function(e){var t,n,i,o=this,c=new s.Action,d=new s.Cache,u=new s.Cursor,h=new s.HtmlAssistant,m=new s.Utilities,f=new s.Selection,p={focus:function(e){e=e||r.event,s.activeElement=t},blur:function(e){e=e||r.event,s.activeElement===t&&(s.activeElement=null),h.placeholders()},down:function(e){e=e||r.event;var t=!0;if(229!==e.keyCode){if(m.isCommand(e,function(){d.cmd=!0},function(){d.cmd=!1}),m.isShift(e,function(){d.shift=!0},function(){d.shift=!1}),m.isModifier(e,function(n){if(d.cmd){if((v.mode===s.inlineMode||v.mode===s.partialMode)&&"paste"!==n)return void m.preventDefaultEvent(e);var i=typeof n,r=null;r="function"===i?n:p.command[n],t=r.call(o,e),!1===t&&(m.preventDefaultEvent(e),m.stopPropagation(e))}}),-1!==v.maxLength){var n=h.text().length,i=!1,a=r.getSelection();if(a&&(i=!a.isCollapsed),n>=v.maxLength&&!m.isSpecial(e)&&!m.isNavigational(e)&&!i)return m.preventDefaultEvent(e)}switch(e.keyCode){case l.enter:p.enterKey(e);break;case l.backspace:case l.delete:p.backspaceOrDeleteKey(e)}return t}},up:function(e){e=e||r.event,m.isCommand(e,function(){d.cmd=!1},function(){d.cmd=!0}),h.clean(),h.placeholders();var t;if(null!==v.keyContext&&(t=v.keyContext[e.keyCode])){var n=u.parent();n&&t.call(o,e,n)}c.preserveElementFocus()},command:{bold:function(e){m.preventDefaultEvent(e),new s.Element(o,"bold").setClean(!1).invoke(v.beforeInvokeElement)},underline:function(e){m.preventDefaultEvent(e),new s.Element(o,"underline").setClean(!1).invoke(v.beforeInvokeElement)},italicize:function(e){m.preventDefaultEvent(e),new s.Element(o,"italic").setClean(!1).invoke(v.beforeInvokeElement)},quote:function(e){},paste:function(e){if(o.makeUndoable(),v.pasteAsText){var t=m.selection.saveSelection();m.pasteHook(function(e){m.selection.restoreSelection(t),e=e.replace(/\n/g,"<br>"),new s.Html(o,e).setClean(!1).insert(v.beforeInsertHtml,!0),h.clean(),h.placeholders()})}else h.clean(),h.placeholders()}},enterKey:function(e){if(v.mode===s.inlineMode)return m.preventDefaultEvent(e);if(!d.shift){var n,i,r,o=h.atCaret()||{},a=t.children,l=o===t.lastChild?t.lastChild:null;l&&l!==t.firstChild&&v.autoHR&&"partial"!==v.mode&&v.tags.horizontalRule&&(m.preventDefaultEvent(e),n=""===h.text(l)&&l.nodeName.toLowerCase()===v.tags.paragraph,n&&a.length>=2&&(i=a[a.length-2],i.nodeName.toLowerCase()===v.tags.horizontalRule&&(n=!1)),n&&(h.addTag(v.tags.horizontalRule,!1,!0,o),o=o.nextSibling),null!==(r=h.addTag(v.tags.paragraph,!0,null,o))&&(r.innerHTML="",u.set(0,r)))}return!0},backspaceOrDeleteKey:function(e){if(null!==t.lastChild){var n=t.lastChild,i=n.previousSibling;n&&v.tags.horizontalRule&&n.nodeName.toLocaleLowerCase()===v.tags.horizontalRule?t.removeChild(n):n&&i&&m.html.text(n).length<1&&i.nodeName.toLowerCase()===v.tags.horizontalRule&&n.nodeName.toLowerCase()===v.tags.paragraph&&(t.removeChild(n),t.removeChild(i))}}},g={element:null,modifier:"auto",placeholder:"",autofocus:!1,autoHR:!0,mode:s.richMode,maxLength:-1,modifiers:{b:"bold",i:"italicize",u:"underline",v:"paste"},tags:{break:"br",horizontalRule:"hr",paragraph:"p",outerLevel:["pre","blockquote","figure"],innerLevel:["a","b","u","i","img","strong"]},cssClasses:{editor:"Medium",pasteHook:"Medium-paste-hook",placeholder:"Medium-placeholder",clear:"Medium-clear"},attributes:{remove:["style","class"]},pasteAsText:!0,beforeInvokeElement:function(){},beforeInsertHtml:function(){},beforeAddTag:function(e,t,n,i){},keyContext:null,pasteEventHandler:function(e){e=e||r.event,o.makeUndoable();var n,i=o.value().length;if(v.pasteAsText){m.preventDefaultEvent(e);var a=m.selection.saveSelection(),l=prompt(s.Messages.pastHere)||"";if(l.length>0)return t.focus(),s.activeElement=t,m.selection.restoreSelection(a),l=h.encodeHtml(l),n=l.length+i,v.maxLength>0&&n>v.maxLength&&(l=l.substring(0,v.maxLength-i)),v.mode!==s.inlineMode&&(l=l.replace(/\n/g,"<br>")),new s.Html(o,l).setClean(!1).insert(v.beforeInsertHtml,!0),h.clean(),h.placeholders(),!1}else setTimeout(function(){h.clean(),h.placeholders()},20)}},v=m.deepExtend(g,e),b={};for(i in g)"object"!=typeof g[i]&&g.hasOwnProperty(i)&&v.element.getAttribute("data-medium-"+l)&&(n=v.element.getAttribute("data-medium-"+l),"false"!==n.toLowerCase()&&"true"!==n.toLowerCase()||(n="true"===n.toLowerCase()),v[i]=n);if(v.modifiers)for(i in v.modifiers)void 0!==l[i]&&(v.modifiers[l[i]]=v.modifiers[i]);if(v.keyContext)for(i in v.keyContext)void 0!==l[i]&&(v.keyContext[l[i]]=v.keyContext[i]);t=v.element,t.contentEditable=!0,t.className+=" "+v.cssClasses.editor+" "+v.cssClasses.editor+"-"+v.mode,v.tags=v.tags||{},v.tags.outerLevel&&(v.tags.outerLevel=v.tags.outerLevel.concat([v.tags.paragraph,v.tags.horizontalRule])),this.settings=v,this.element=t,this.intercept=p,this.action=c,this.cache=d,this.cursor=u,this.html=h,this.utils=m,this.selection=f,b.element=t,b.medium=this,b.settings=v,b.action=c,b.cache=d,b.cursor=u,b.html=h,b.intercept=p,b.utils=m,b.selection=f,c.setBridge(b),d.setBridge(b),u.setBridge(b),h.setBridge(b),m.setBridge(b),f.setBridge(b),h.clean(),h.placeholders(),c.preserveElementFocus(),c.listen(),a?this.makeUndoable=function(){}:(this.dirty=!1,this.undoable=new s.Undoable(this),this.undo=this.undoable.undo,this.redo=this.undoable.redo,this.makeUndoable=this.undoable.makeUndoable),t.medium=this,d.initialized=!0};return s.prototype={insertHtml:function(e,t){var n=new s.Html(this,e).insert(this.settings.beforeInsertHtml);return this.utils.triggerEvent(this.element,"change"),t&&t.apply(n),this},invokeElement:function(e,n){var i=this.settings,n=n||{},r=n.remove||[];switch(i.mode){case s.inlineMode:case s.partialMode:return this}return r.length>0&&(t(i,"class")||r.push("class")),new s.Element(this,e,n).invoke(this.settings.beforeInvokeElement),this.utils.triggerEvent(this.element,"change"),this},behavior:function(){return a?"wild":"domesticated"},value:function(e){return void 0===e?this.element.innerHTML:(this.element.innerHTML=e,this.html.clean(),this.html.placeholders(),this)},focus:function(){return this.element.focus(),this},select:function(){var e,t,n=this.element;return n.focus(),o.body.createTextRange?(e=o.body.createTextRange(),e.moveToElementText(n),e.select()):r.getSelection&&(t=r.getSelection(),e=o.createRange(),e.selectNodeContents(n),t.removeAllRanges(),t.addRange(e)),this},isActive:function(){return s.activeElement===this.element},destroy:function(){var t=this.element,n=this.intercept,i=this.settings,r=this.placeholder||null;null!==r&&r.setup&&(r.parentNode.removeChild(r),delete t.placeHolderActive),t.removeAttribute("contenteditable"),t.className=e(t.className.replace(i.cssClasses.editor,"").replace(i.cssClasses.clear,"").replace(i.cssClasses.editor+"-"+i.mode,"")),this.utils.removeEvent(t,"keyup",n.up).removeEvent(t,"keydown",n.down).removeEvent(t,"focus",n.focus).removeEvent(t,"blur",n.focus).removeEvent(t,"paste",i.pasteEventHandler)},clear:function(){this.element.innerHTML="",this.html.placeholders()}},s.Element=function(e,t,n){if(this.medium=e,this.element=e.settings.element,a)this.tagName=t;else switch(t.toLowerCase()){case"bold":this.tagName="b";break;case"italic":this.tagName="i";break;case"underline":this.tagName="u";break;default:this.tagName=t}this.attributes=n||{},this.clean=!0},s.Html=function(e,t){this.medium=e,this.element=e.settings.element,this.html=t,this.clean=!0},s.Injector=function(){},a?(s.Element.prototype={invoke:function(e){s.activeElement===this.element&&(e&&e.apply(this),o.execCommand(this.tagName,!1))},setClean:function(){return this}},s.Injector.prototype={inject:function(e,t){return this.insertHTML(e,t),null}},s.Undoable=function(){}):(n.rangePrototype.insertNodeAtEnd=function(e){var t=this.cloneRange();t.collapse(!1),t.insertNode(e),t.detach(),this.setEndAfter(e)},s.Element.prototype={invoke:function(e){if(s.activeElement===this.element){e&&e.apply(this);var t,i,o=this.attributes,a=this.tagName.toLowerCase();void 0!==o.className?(i=(o.className.split[" "]||[o.className]).shift(),delete o.className):i="medium-"+a,t=n.createClassApplier(i,{elementTagName:a,elementAttributes:this.attributes}),this.medium.makeUndoable(),t.toggleSelection(r),this.clean&&(this.medium.html.clean(),this.medium.html.placeholders())}},setClean:function(e){return this.clean=e,this}},s.Injector.prototype={inject:function(e){var t,n=!1;if("string"==typeof e){var i=o.createElement("div");i.innerHTML=e,t=i.childNodes,n=!0}else t=e;this.insertHTML('<span id="wedge"></span>');var r=o.getElementById("wedge"),a=r.parentNode;if(r.removeAttribute("id"),n)for(;0<t.length;)a.insertBefore(t[0],r);else a.insertBefore(t,r);return a.removeChild(r),r=null,t}},s.Undoable=function(e){var t,n=this,i=e.settings.element,r=e.utils,o=r.addEvent,a=i.innerHTML,s=new Undo.Stack,c=Undo.Command.extend({constructor:function(e,t){this.oldValue=e,this.newValue=t},execute:function(){},undo:function(){i.innerHTML=this.oldValue,e.canUndo=s.canUndo(),e.canRedo=s.canRedo(),e.dirty=s.dirty()},redo:function(){i.innerHTML=this.newValue,e.canUndo=s.canUndo(),e.canRedo=s.canRedo(),e.dirty=s.dirty()}}),d=function(){var t=i.innerHTML;t!=a&&(n.movingThroughStack||(s.execute(new c(a,t)),a=t,e.dirty=s.dirty()),r.triggerEvent(e.settings.element,"change"))};this.medium=e,this.timer=t,this.stack=s,this.makeUndoable=d,this.EditCommand=c,this.movingThroughStack=!1,o(i,"keyup",function(e){if(e.ctrlKey||e.keyCode===l.z)return void r.preventDefaultEvent(e);clearTimeout(t),t=setTimeout(function(){d()},250)}),o(i,"keydown",function(e){if(!e.ctrlKey||e.keyCode!==l.z)return n.movingThroughStack=!1,!0;r.preventDefaultEvent(e),n.movingThroughStack=!0,e.shiftKey?s.canRedo()&&s.redo():s.canUndo()&&s.undo()})}),s.Injector.prototype.insertHTML=function(e,t){var n,i;if(r.getSelection){if(n=r.getSelection(),n.getRangeAt&&n.rangeCount){i=n.getRangeAt(0),i.deleteContents();var a=o.createElement("div");a.innerHTML=e;for(var l,s,c=o.createDocumentFragment();l=a.firstChild;)s=c.appendChild(l);var d=c.firstChild;i.insertNode(c),s&&(i=i.cloneRange(),i.setStartAfter(s),t?i.setStartBefore(d):i.collapse(!0),n.removeAllRanges(),n.addRange(i))}}else if((n=o.selection)&&"Control"!=n.type){var u=n.createRange();u.collapse(!0),n.createRange().pasteHTML(e),t&&(i=n.createRange(),i.setEndPoint("StartToStart",u),i.select())}},s.Html.prototype={setBridge:function(e){for(var t in e)this[t]=e[t]},insert:function(e,t){if(s.activeElement===this.element){e&&e.apply(this);var n=this.injector.inject(this.html,t);return this.clean&&(this.medium.html.clean(),this.medium.html.placeholders()),this.medium.makeUndoable(),n}return null},injector:new s.Injector,setClean:function(e){return this.clean=e,this}},s.Utilities=function(){},s.Utilities.prototype={setBridge:function(e){for(var t in e)this[t]=e[t]},isCommand:function(e,t,n){var i=this.settings;return"ctrl"===i.modifier&&e.ctrlKey||"cmd"===i.modifier&&e.metaKey||"auto"===i.modifier&&(e.ctrlKey||e.metaKey)?t.call():n.call()},isShift:function(e,t,n){return e.shiftKey?t.call():n.call()},isModifier:function(e,t){var n=this.settings.modifiers[e.keyCode];return!!n&&t.call(null,n)},special:function(){var e={};return e[l.backspace]=!0,e[l.shift]=!0,e[l.ctrl]=!0,e[l.alt]=!0,e[l.delete]=!0,e[l.cmd]=!0,e}(),isSpecial:function(e){return!!this.cache.cmd||void 0!==this.special[e.keyCode]},navigational:function(){var e={};return e[l.upArrow]=!0,e[l.downArrow]=!0,e[l.leftArrow]=!0,e[l.rightArrow]=!0,e}(),isNavigational:function(e){return void 0!==this.navigational[e.keyCode]},addEvent:function(e,t,n){return e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n,this},removeEvent:function(e,t,n){return e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null,this},preventDefaultEvent:function(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this},stopPropagation:function(e){e=e||window.event,e.cancelBubble=!0,void 0!==e.stopPropagation&&e.stopPropagation()},triggerEvent:function(e,t){var n;return o.createEvent?(n=o.createEvent("HTMLEvents"),n.initEvent(t,!0,!0),n.eventName=t,e.dispatchEvent(n)):(n=o.createEventObject(),e.fireEvent("on"+t,n)),this},deepExtend:function(e,t){for(var n in t)t[n]&&t[n].constructor&&t[n].constructor===Object?(e[n]=e[n]||{},this.deepExtend(e[n],t[n])):e[n]=t[n];return e},pasteHook:function(e){var t,n,i,r=o.createElement("textarea"),l=this.element,s=this.settings,c=this.medium,d=this.html;r.className=s.cssClasses.pasteHook,l.parentNode.appendChild(r),r.focus(),a||c.makeUndoable(),setTimeout(function(){l.focus(),s.maxLength>0&&(t=d.text(l),n=t.length,(i=n+r.value.length)>n&&(r.value=r.value.substring(0,s.maxLength-n))),e(r.value),d.deleteNode(r)},2)},setupContents:function(){var e,t=this.element,n=t.children,i=t.childNodes;!this.settings.tags.paragraph||n.length>0||this.settings.mode===s.inlineMode||(i.length>0?(e=o.createElement(this.settings.tags.paragraph),t.innerHTML.match("^[&]nbsp[;]")&&(t.innerHTML=t.innerHTML.substring(6,t.innerHTML.length-1)),e.innerHTML=t.innerHTML,t.innerHTML="",t.appendChild(e),this.cursor.set(e.innerHTML.length,e)):(e=o.createElement(this.settings.tags.paragraph),e.innerHTML="&nbsp;",t.appendChild(e)))},traverseAll:function(e,t,n){var i,r=e.childNodes,o=r.length,a=0,n=n||1;if(t=t||{},o>0)for(;a<o;a++){switch(i=r[a],i.nodeType){case 1:this.traverseAll(i,t,n+1),void 0!==t.element&&t.element(i,a,n,e);break;case 3:void 0!==t.fragment&&t.fragment(i,a,n,e)}o=r.length,i===e.lastChild&&(a=o)}}},s.Selection=function(){},s.Selection.prototype={setBridge:function(e){for(var t in e)this[t]=e[t]},saveSelection:function(){if(r.getSelection){var e=r.getSelection();if(e.rangeCount>0)return e.getRangeAt(0)}else if(o.selection&&o.selection.createRange)return o.selection.createRange();return null},restoreSelection:function(e){if(e)if(r.getSelection){var t=r.getSelection();t.removeAllRanges(),t.addRange(e)}else o.selection&&e.select&&e.select()}},s.Cursor=function(){},s.Cursor.prototype={setBridge:function(e){for(var t in e)this[t]=e[t]},set:function(e,t){var n,i=this.html;if(o.createRange){var a=r.getSelection(),l=i.lastChild(),s=i.text(l).length-1,c=t||l,d=void 0!==e&&null!==e?e:s;n=o.createRange(),n.setStart(c,d),n.collapse(!0),a.removeAllRanges(),a.addRange(n)}else n=o.body.createTextRange(),n.moveToElementText(t),n.collapse(!1),n.select()},parent:function(){var e,t=null;return r.getSelection?(e=r.getSelection().getRangeAt(0),t=e.commonAncestorContainer,t=1===t.nodeType?t:t.parentNode):o.selection&&(t=o.selection.createRange().parentElement()),"SPAN"==t.tagName&&(t=t.parentNode),t},caretToBeginning:function(e){this.set(0,e)},caretToEnd:function(e){this.set(this.html.text(e).length,e)}},s.HtmlAssistant=function(){},s.HtmlAssistant.prototype={setBridge:function(e){for(var t in e)this[t]=e[t]},encodeHtml:function(e){return o.createElement("a").appendChild(o.createTextNode(e)).parentNode.innerHTML},text:function(t,n){if(t=t||this.settings.element,n)t.textContent&&void 0!==t.textContent?t.textContent=n:t.innerText=n;else{if(t.innerText)return e(t.innerText);if(t.textContent)return e(t.textContent);if(t.data)return e(t.data)}return""},changeTag:function(e,t){var n,i,r=o.createElement(t);for(n=e.firstChild;n;)i=n.nextSibling,r.appendChild(n),n=i;return e.parentNode.insertBefore(r,e),e.parentNode.removeChild(e),r},deleteNode:function(e){e.parentNode.removeChild(e)},placeholders:function(){if(r.getComputedStyle){var t=this.settings,n=this.medium.placeholder||(this.medium.placeholder=o.createElement("div")),i=t.element,a=n.style,l=r.getComputedStyle(i,null),c=function(e){return l.getPropertyValue(e)},d=this.utils,u=d.html.text(i),h=this.cursor,m=i.children.length;if(i.placeholder=n,u.length<1&&m<2){if(i.placeHolderActive)return;i.innerHTML.match("<"+t.tags.paragraph)||(i.innerHTML=""),t.placeholder.length>0&&(n.setup||(n.setup=!0,a.background=c("background"),a.backgroundColor=c("background-color"),a.fontSize=c("font-size"),a.color=l.color,a.marginTop=c("margin-top"),a.marginBottom=c("margin-bottom"),a.marginLeft=c("margin-left"),a.marginRight=c("margin-right"),a.paddingTop=c("padding-top"),a.paddingBottom=c("padding-bottom"),a.paddingLeft=c("padding-left"),a.paddingRight=c("padding-right"),a.borderTopWidth=c("border-top-width"),a.borderTopColor=c("border-top-color"),a.borderTopStyle=c("border-top-style"),a.borderBottomWidth=c("border-bottom-width"),a.borderBottomColor=c("border-bottom-color"),a.borderBottomStyle=c("border-bottom-style"),a.borderLeftWidth=c("border-left-width"),a.borderLeftColor=c("border-left-color"),a.borderLeftStyle=c("border-left-style"),a.borderRightWidth=c("border-right-width"),a.borderRightColor=c("border-right-color"),a.borderRightStyle=c("border-right-style"),n.className=t.cssClasses.placeholder+" "+t.cssClasses.placeholder+"-"+t.mode,n.innerHTML="<div>"+t.placeholder+"</div>",i.parentNode.insertBefore(n,i)),i.className+=" "+t.cssClasses.clear,a.display="",a.minHeight=i.clientHeight+"px",a.minWidth=i.clientWidth+"px",t.mode!==s.inlineMode&&(d.setupContents(),0===m&&i.firstChild&&h.set(0,i.firstChild))),i.placeHolderActive=!0}else i.placeHolderActive&&(i.placeHolderActive=!1,a.display="none",i.className=e(i.className.replace(t.cssClasses.clear,"")),d.setupContents())}},clean:function(e){var t,n,i,o=this.settings,a=o.cssClasses.placeholder,l=(o.attributes||{}).remove||[],s=o.tags||{},c=s.outerLevel||null,d=s.innerLevel||null,u={},h={},m=(s.paragraph||"").toUpperCase(),f=this.html;if(e=e||o.element,null!==c)for(i=0;i<c.length;i++)u[c[i].toUpperCase()]=!0;if(null!==d)for(i=0;i<d.length;i++)h[d[i].toUpperCase()]=!0;this.utils.traverseAll(e,{element:function(e,o,s,p){var g=e.nodeName,v=!0;for(i=0;i<l.length;i++)t=l[i],e.hasAttribute(t)&&e.getAttribute(t)!==a&&e.removeAttribute(t);if((null!==c||null!==d)&&(1===s&&void 0!==u[g]?v=!1:s>1&&void 0!==h[g]&&(v=!1),v))if("block"===r.getComputedStyle(e,null).getPropertyValue("display")){if(m.length>0&&m!==g&&f.changeTag(e,m),s>1)for(;p.childNodes.length>o;)p.parentNode.insertBefore(p.lastChild,p.nextSibling)}else switch(g){case"BR":if(e===e.parentNode.lastChild){if(e===e.parentNode.firstChild)break;n=document.createTextNode(""),n.innerHTML="&nbsp",p.insertBefore(n,e);break}default:for(;null!==e.firstChild;)p.insertBefore(e.firstChild,e);f.deleteNode(e)}}})},lastChild:function(){return this.element.lastChild},addTag:function(e,t,n,i){if(!this.settings.beforeAddTag(e,t,n,i)){var r,a=o.createElement(e);return void 0!==n&&!1===n&&(a.contentEditable=!1),0==a.innerHTML.length&&(a.innerHTML=" "),i&&i.nextSibling?(i.parentNode.insertBefore(a,i.nextSibling),r=i.nextSibling):(this.settings.element.appendChild(a),r=this.html.lastChild()),t&&(this.cache.focusedElement=r,this.cursor.set(0,r)),a}return null},baseAtCaret:function(){if(!this.medium.isActive())return null;var e=r.getSelection?r.getSelection():document.selection;if(e.rangeCount){var t=e.getRangeAt(0),n=t.endContainer;switch(n.nodeType){case 3:if(n.data&&n.data.length!=t.endOffset)return!1}return n}return null},atCaret:function(){var e=this.baseAtCaret()||{},t=this.element;if(!1===e)return null;for(;e&&e.parentNode!==t;)e=e.parentNode;return e&&1==e.nodeType?e:null}},s.Action=function(){},s.Action.prototype={setBridge:function(e){for(var t in e)this[t]=e[t]},listen:function(){var e=this.element,t=this.intercept;this.utils.addEvent(e,"keyup",t.up).addEvent(e,"keydown",t.down).addEvent(e,"focus",t.focus).addEvent(e,"blur",t.blur).addEvent(e,"paste",this.settings.pasteEventHandler)},preserveElementFocus:function(){var e=r.getSelection?r.getSelection().anchorNode:o.activeElement;if(e){var t,n=this.medium.cache,i=this.settings,a=e.parentNode,l=i.element.children,s=a!==n.focusedElement,c=0;for(a===i.element&&(a=e),t=0;t<l.length;t++)if(a===l[t]){c=t;break}s&&(n.focusedElement=a,n.focusedElementIndex=c)}}},s.Cache=function(){this.initialized=!1,this.cmd=!1,this.focusedElement=null},s.Cache.prototype={setBridge:function(e){for(var t in e)this[t]=e[t]}},s.inlineMode="inline",s.partialMode="partial",s.richMode="rich",s.Messages={pastHere:"Paste Here"},s}();void 0!==(i=function(){return a}.call(t,n,t,e))&&(e.exports=i)}).call(this,window,document)}]);